<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>é—œå¡äº”ï¼šæ‰“é€ å¥åº·æ£²åœ°ï¼ˆæ–¹æ¡ˆ2ï¼‰</title>
  <style>
    body {
      font-family: "Microsoft JhengHei", sans-serif;
      margin: 0; padding: 0;
      background: #d8f0d8;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
    }
    h1 {
      margin-top: 20px;
    }
    #game {
      display: flex;
      gap: 50px;
      margin-top: 20px;
    }
    #items {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    .draggable {
      width: 100px;
      height: 100px;
      cursor: grab;
    }
    #targets {
      display: flex;
      gap: 25px;
    }
    .dropzone {
      width: 120px;
      height: 120px;
      border: 2px dashed #666;
      background-color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
    }
    .dropzone.correct {
      border-color: green;
    }
    .dropzone.incorrect {
      border-color: red;
    }
    #message {
      margin-top: 20px;
      font-size: 18px;
      min-height: 28px;
    }
    button {
      margin-top: 15px;
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    #restartBtn {
      background-color: #f44336;
      color: white;
    }
    #nextBtn {
      background-color: #4caf50;
      color: white;
      display: none;
    }
  </style>
</head>
<body>

<!-- ğŸ”Š èƒŒæ™¯éŸ³æ¨‚ -->
<audio id="bgMusic" src="impage/background.mp3" autoplay loop></audio>
<script>
  const bgMusic = document.getElementById("bgMusic");
  bgMusic.volume = 0.3;
</script>

<h1>é—œå¡äº”ï¼šæ‰“é€ å¥åº·æ£²åœ°</h1>
<div id="game">
  <div id="items">
    <img src="images/bear.png" class="draggable" draggable="true" data-target="forest" alt="é»‘ç†Š" id="bear" title="é»‘ç†Š â†’ æ£®æ—" />
    <img src="images/frog.png" class="draggable" draggable="true" data-target="wetland" alt="é’è›™" id="frog" title="é’è›™ â†’ æ¿•åœ°" />
    <img src="images/sparrow.png" class="draggable" draggable="true" data-target="farm" alt="éº»é›€" id="sparrow" title="éº»é›€ â†’ è¾²ç”°" />
    <img src="images/factory.png" class="draggable" draggable="true" data-target="wrong" alt="å·¥å» " id="factory" title="å·¥å»  â†’ éŒ¯èª¤é …ç›®" />
  </div>
  <div id="targets">
    <div class="dropzone" data-name="forest" title="æ£®æ—">
      <img src="images/forest.png" alt="æ£®æ—" width="100" />
    </div>
    <div class="dropzone" data-name="wetland" title="æ¿•åœ°">
      <img src="images/wetland.png" alt="æ¿•åœ°" width="100" />
    </div>
    <div class="dropzone" data-name="farm" title="è¾²ç”°">
      <img src="images/farm.png" alt="è¾²ç”°" width="100" />
    </div>
  </div>
</div>

<div id="message">è«‹å°‡å‹•ç‰©èˆ‡ç‰©ä»¶æ‹–æ›³åˆ°æ­£ç¢ºæ£²åœ°</div>
<button id="restartBtn" onclick="initGame()">é‡æ–°é–‹å§‹</button>
<button id="nextBtn" onclick="location.href='end.html'">å®ŒæˆéŠæˆ²</button>

<script>
  let correctCount = 0;
  const totalCorrect = 3;

  function initGame() {
    correctCount = 0;
    document.getElementById('message').textContent = 'è«‹å°‡å‹•ç‰©èˆ‡ç‰©ä»¶æ‹–æ›³åˆ°æ­£ç¢ºæ£²åœ°';
    document.getElementById('nextBtn').style.display = 'none';

    document.querySelectorAll('.draggable').forEach(item => {
      item.style.visibility = 'visible';
      item.draggable = true;
    });

    document.querySelectorAll('.dropzone').forEach(zone => {
      zone.classList.remove('correct', 'incorrect');
    });
  }

  document.querySelectorAll('.dropzone').forEach(zone => {
    zone.addEventListener('dragover', e => e.preventDefault());

    zone.addEventListener('drop', e => {
      e.preventDefault();
      const dragged = document.querySelector('.dragging');
      if (!dragged) return;

      const dropName = zone.getAttribute('data-name');
      const targetName = dragged.getAttribute('data-target');

      if (targetName === dropName) {
        zone.classList.add('correct');
        dragged.style.visibility = 'hidden';
        dragged.draggable = false;
        correctCount++;
        document.getElementById('message').textContent = `âœ”ï¸ æ”¾ç½®æ­£ç¢ºï¼å·²å®Œæˆ ${correctCount} / ${totalCorrect}`;
      } else {
        zone.classList.add('incorrect');
        document.getElementById('message').textContent = 'âŒ æ”¾ç½®éŒ¯èª¤ï¼ŒæŒ‘æˆ°å¤±æ•—ï¼Œè«‹é‡æ–°é–‹å§‹';
        document.querySelectorAll('.draggable').forEach(item => item.draggable = false);
        return;
      }

      if (correctCount >= totalCorrect) {
        document.getElementById('message').textContent = 'ğŸ‰ æŒ‘æˆ°æˆåŠŸï¼';
        document.getElementById('nextBtn').style.display = 'inline-block';
      }
    });
  });

  document.querySelectorAll('.draggable').forEach(item => {
    item.addEventListener('dragstart', () => {
      item.classList.add('dragging');
    });
    item.addEventListener('dragend', () => {
      item.classList.remove('dragging');
    });
  });

  initGame();
</script>
</body>
</html>
